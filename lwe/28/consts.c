#include <stdio.h>
#include <stdint.h>
#include "consts.h"

int pad_array(int8_t *buf, int size)
{
    int pad_bytes = (int) PAD_SIZE;
    pad_bytes = (pad_bytes - (size % pad_bytes)) % pad_bytes;
    for (int i = 0; i < pad_bytes; i++)
    {
        buf[size + i] = pad_bytes;
    }

    return size + pad_bytes;
}

int unpad_array(int8_t *buf, int size)
{
    if (size == 0) return size;

    int last_value = buf[size - 1];
    int counter = 1;

    if (last_value > size || last_value >= PAD_SIZE) return size;

    for (int i = 2; i <= size; i++)
    {
        if (buf[size - i] == last_value) counter++;
        else break;
    }

    if (counter >= last_value) return (size - last_value);

    return size;
}

int32_t zetas[NEWHOPE_N / 2] = { 409584, 112988140, 170548854, 36702217, 55642053, 235140237, 204440910, 11189567, 215067574, 122546148, 78349622, 245442359, 118271847, 174766379, 7046001, 131335041, 43180476, 67036911, 196728300, 197151769, 168876515, 57113304, 137228627, 200617514, 194759550, 205072839, 6964243, 164714357, 183294608, 145961053, 186653364, 10435639, 268009594, 44367853, 6868477, 12552882, 97304636, 25364231, 63380183, 182711087, 60969324, 169767031, 206245947, 126338435, 204155111, 137189742, 127832393, 244238386, 105572309, 43802455, 186024778, 96011895, 234591194, 64267842, 135670523, 80634574, 247041830, 42137651, 141772374, 164097281, 143452914, 221979114, 174370596, 242348298, 38658902, 20709761, 139604536, 140490204, 103664063, 168222532, 105126282, 48798150, 169290079, 264129428, 51483834, 34287674, 253721016, 261091910, 15198954, 257128416, 20173897, 261234008, 91307915, 113778926, 265300796, 215906068, 69111936, 157268173, 57691270, 212705652, 166209281, 172844546, 173843130, 27403108, 246919194, 176394949, 64101329, 93435847, 37033881, 193548143, 76393112, 24598309, 195499713, 60358102, 4176497, 201328454, 227947159, 198826939, 56212016, 29486788, 39789083, 259938046, 214953131, 198409488, 57036151, 236311170, 94068584, 114831382, 86467032, 30311781, 46917583, 201945174, 109437248, 247327871, 183205078, 250917607, 206787660, 248684720, 212544856, 47700621, 54255629, 232641881, 241514581, 34724453, 169158745, 82024613, 135820148, 15614207, 169755471, 244556575, 69289705, 234630723, 107639639, 88082865, 49260366, 97811270, 182600836, 239385267, 189416188, 260672840, 178050285, 245183842, 51182490, 219254001, 27896355, 43838285, 212096425, 44997598, 170758240, 75752806, 169742456, 182555989, 13084797, 61769817, 41515544, 154266055, 55361065, 92283106, 92594417, 83894791, 192014372, 161852304, 118733768, 235855195, 202718088, 222525757, 239407266, 116735397, 42663290, 223093330, 137934613, 105220469, 139976775, 125173605, 47844302, 159830083, 190550194, 160002168, 29600115, 125614867, 157811508, 254488521, 109306076, 14828837, 60241193, 21185961, 204624902, 56451505, 238210662, 155832655, 126599277, 228932120, 58708535, 246636665, 134620667, 219004188, 225365057, 86545478, 226526434, 5868665, 66278696, 70519747, 219568494, 102283048, 69899367, 250122243, 81989881, 127364102, 221942451, 241789631, 24385879, 215121335, 20619967, 118598247, 50105098, 135459003, 122700757, 58322241, 88443424, 11135490, 26871648, 217416159, 63208100, 225383770, 181962646, 230787111, 130087884, 234810534, 55213622, 263884253, 148911136, 35355614, 209977766, 96932292, 219211541, 263465853, 174895514, 136509822, 259510941, 232581902, 84748982, 178774170, 69047364, 53644666, 63841393, 241299650, 213222567, 54464209, 84087691, 233527112, 101328015, 130690735, 175880461, 242906212, 35367297, 237971965, 142614493, 45327285, 204239662, 114764626, 60844016, 11872910, 264499180, 67129851, 98413737, 32287223, 90646657, 262647990, 176957907, 41493280, 151916483, 221082134, 185259808, 9660624, 215851801, 227916407, 199104327, 140081982, 139800987, 142359702, 47546465, 73996121, 48447254, 6006691, 71699791, 125185721, 22177405, 266817516, 95338264, 267776308, 87923415, 46276702, 215461773, 75729573, 212401194, 201264410, 12105579, 206178451, 3795142, 139664632, 215495551, 254912587, 231474114, 224794109, 216113448, 258591616, 251749299, 103422682, 155831276, 155968480, 259894270, 67885960, 244833278, 237390985, 141743723, 15401359, 229395587, 179267655, 186197887, 2585682, 169527668, 44476910, 88469527, 107457603, 174450388, 35195910, 171721956, 121080115, 3375122, 211199046, 79350909, 120125927, 12538600, 91647515, 142924000, 228825707, 262342230, 66332831, 40913410, 192805230, 149725819, 60957696, 6577981, 73714590, 179706169, 169173312, 122875285, 254151276, 1814960, 224412936, 87241605, 126649140, 136059418, 132949551, 215318117, 197603592, 118792344, 156819158, 263920684, 158591940, 24653838, 190980772, 149518455, 78848897, 252114568, 39435205, 83285202, 132644861, 41318958, 60186811, 45910865, 202460433, 213027294, 183203150, 43854857, 214982144, 200237411, 256635112, 252133948, 214043479, 43431397, 24507844, 245785804, 65560947, 97403933, 48376194, 35115281, 158867203, 134779370, 252726214, 238595734, 179603523, 244097059, 129452612, 158456273, 71781986, 215656679, 185419136, 29639006, 230287865, 85352118, 216240545, 238210011, 104844559, 230487202, 28812971, 141293537, 156020923, 89005556, 9735446, 14771150, 195209751, 195582783, 165608647, 146167753, 263837025, 55659570, 49847530, 252394911, 99614470, 149315284, 139420675, 157413167, 257671331, 2106320, 162891917, 74485971, 38896027, 117290743, 170221436, 20149341, 225468478, 162222397, 32769343, 195192678, 241167290, 2358316, 168689341, 173097913, 113951694, 91159182, 120024341, 165737187, 159789365, 198499104, 210039754, 215741507, 131502209, 19799202, 185616753, 177908243, 163215298, 42716218, 2260088, 9492168, 26456614, 70349640, 186820728, 62952182, 177103728, 42206167, 140748281, 51117361, 194459001, 56897505, 201393225, 260873166, 192642412, 156356145, 219459840, 22792662, 256682781, 188616377, 151842381, 219635073, 73662913, 195028465, 142012920, 264474674, 214632666, 230176129, 64048809, 17183524, 258782592, 247933598, 111172727, 32449580, 230157920, 250666288, 172013019, 232616967, 100872690, 174246190, 62332894, 85235808, 132269322, 137874262, 254271755, 251037242, 143872451, 92926626, 164132964 };

int32_t zetas_inv[NEWHOPE_N / 2] = { 104276893, 175483231, 124537406, 17372615, 14138102, 130535595, 136140535, 183174049, 206076963, 94163667, 167537167, 35792890, 96396838, 17743569, 38251937, 235960277, 157237130, 20476259, 9627265, 251226333, 204361048, 38233728, 53777191, 3935183, 126396937, 73381392, 194746944, 48774784, 116567476, 79793480, 11727076, 245617195, 48950017, 112053712, 75767445, 7536691, 67016632, 211512352, 73950856, 217292496, 127661576, 226203690, 91306129, 205457675, 81589129, 198060217, 241953243, 258917689, 266149769, 225693639, 105194559, 90501614, 82793104, 248610655, 136907648, 52668350, 58370103, 69910753, 108620492, 102672670, 148385516, 177250675, 154458163, 95311944, 99720516, 266051541, 27242567, 73217179, 235640514, 106187460, 42941379, 248260516, 98188421, 151119114, 229513830, 193923886, 105517940, 266303537, 10738526, 110996690, 128989182, 119094573, 168795387, 16014946, 218562327, 212750287, 4572832, 122242104, 102801210, 72827074, 73200106, 253638707, 258674411, 179404301, 112388934, 127116320, 239596886, 37922655, 163565298, 30199846, 52169312, 183057739, 38121992, 238770851, 82990721, 52753178, 196627871, 109953584, 138957245, 24312798, 88806334, 29814123, 15683643, 133630487, 109542654, 233294576, 220033663, 171005924, 202848910, 22624053, 243902013, 224978460, 54366378, 16275909, 11774745, 68172446, 53427713, 224555000, 85206707, 55382563, 65949424, 222498992, 208223046, 227090899, 135764996, 185124655, 228974652, 16295289, 189560960, 118891402, 77429085, 243756019, 109817917, 4489173, 111590699, 149617513, 70806265, 53091740, 135460306, 132350439, 141760717, 181168252, 43996921, 266594897, 14258581, 145534572, 99236545, 88703688, 194695267, 261831876, 207452161, 118684038, 75604627, 227496447, 202077026, 6067627, 39584150, 125485857, 176762342, 255871257, 148283930, 189058948, 57210811, 265034735, 147329742, 96687901, 233213947, 93959469, 160952254, 179940330, 223932947, 98882189, 265824175, 82211970, 89142202, 39014270, 253008498, 126666134, 31018872, 23576579, 200523897, 8515587, 112441377, 112578581, 164987175, 16660558, 9818241, 52296409, 43615748, 36935743, 13497270, 52914306, 128745225, 264614715, 62231406, 256304278, 67145447, 56008663, 192680284, 52948084, 222133155, 180486442, 633549, 173071593, 1592341, 246232452, 143224136, 196710066, 262403166, 219962603, 194413736, 220863392, 126050155, 128608870, 128327875, 69305530, 40493450, 52558056, 258749233, 83150049, 47327723, 116493374, 226916577, 91451950, 5761867, 177763200, 236122634, 169996120, 201280006, 3910677, 256536947, 207565841, 153645231, 64170195, 223082572, 125795364, 30437892, 233042560, 25503645, 92529396, 137719122, 167081842, 34882745, 184322166, 213945648, 55187290, 27110207, 204568464, 214765191, 199362493, 89635687, 183660875, 35827955, 8898916, 131900035, 93514343, 4944004, 49198316, 171477565, 58432091, 233054243, 119498721, 4525604, 213196235, 33599323, 138321973, 37622746, 86447211, 43026087, 205201757, 50993698, 241538209, 257274367, 179966433, 210087616, 145709100, 132950854, 218304759, 149811610, 247789890, 53288522, 244023978, 26620226, 46467406, 141045755, 186419976, 18287614, 198510490, 166126809, 48841363, 197890110, 202131161, 262541192, 41883423, 181864379, 43044800, 49405669, 133789190, 21773192, 209701322, 39477737, 141810580, 112577202, 30199195, 211958352, 63784955, 247223896, 208168664, 253581020, 159103781, 13921336, 110598349, 142794990, 238809742, 108407689, 77859663, 108579774, 220565555, 143236252, 128433082, 163189388, 130475244, 45316527, 225746567, 151674460, 29002591, 45884100, 65691769, 32554662, 149676089, 106557553, 76395485, 184515066, 175815440, 176126751, 213048792, 114143802, 226894313, 206640040, 255325060, 85853868, 98667401, 192657051, 97651617, 223412259, 56313432, 224571572, 240513502, 49155856, 217227367, 23226015, 90359572, 7737017, 78993669, 29024590, 85809021, 170598587, 219149491, 180326992, 160770218, 33779134, 199120152, 23853282, 98654386, 252795650, 132589709, 186385244, 99251112, 233685404, 26895276, 35767976, 214154228, 220709236, 55865001, 19725137, 61622197, 17492250, 85204779, 21081986, 158972609, 66464683, 221492274, 238098076, 181942825, 153578475, 174341273, 32098687, 211373706, 70000369, 53456726, 8471811, 228620774, 238923069, 212197841, 69582918, 40462698, 67081403, 264233360, 208051755, 72910144, 243811548, 192016745, 74861714, 231375976, 174974010, 204308528, 92014908, 21490663, 241006749, 94566727, 95565311, 102200576, 55704205, 210718587, 111141684, 199297921, 52503789, 3109061, 154630931, 177101942, 7175849, 248235960, 11281441, 253210903, 7317947, 14688841, 234122183, 216926023, 4280429, 99119778, 219611707, 163283575, 100187325, 164745794, 127919653, 128805321, 247700096, 229750955, 26061559, 94039261, 46430743, 124956943, 104312576, 126637483, 226272206, 21368027, 187775283, 132739334, 204142015, 33818663, 172397962, 82385079, 224607402, 162837548, 24171471, 140577464, 131220115, 64254746, 142071422, 62163910, 98642826, 207440533, 85698770, 205029674, 243045626, 171105221, 255856975, 261541380, 224042004, 400263, 257974218, 81756493, 122448804, 85115249, 103695500, 261445614, 63337018, 73650307, 67792343, 131181230, 211296553, 99533342, 71258088, 71681557, 201372946, 225229381, 137074816, 261363856, 93643478, 150138010, 22967498, 190060235, 145863709, 53342283, 257220290, 63968947, 33269620, 212767804, 231707640, 97861003, 155421717, 193449472 };

int32_t zetas_avx[1152] = { 409584, 112988140, 170548854, 36702217, 55642053, 235140237, 204440910, 11189567, 215067574, 122546148, 78349622, 245442359, 118271847, 174766379, 7046001, 131335041, 43180476, 67036911, 196728300, 197151769, 168876515, 57113304, 137228627, 200617514, 194759550, 205072839, 6964243, 164714357, 183294608, 145961053, 186653364, 10435639, 268009594, 44367853, 6868477, 12552882, 97304636, 25364231, 63380183, 182711087, 60969324, 169767031, 206245947, 126338435, 204155111, 137189742, 127832393, 244238386, 105572309, 43802455, 186024778, 96011895, 234591194, 64267842, 135670523, 80634574, 247041830, 42137651, 141772374, 164097281, 143452914, 221979114, 174370596, 242348298, 38658902, 20709761, 139604536, 140490204, 103664063, 168222532, 105126282, 48798150, 169290079, 264129428, 51483834, 34287674, 253721016, 261091910, 15198954, 257128416, 20173897, 261234008, 91307915, 113778926, 265300796, 215906068, 69111936, 157268173, 57691270, 212705652, 166209281, 172844546, 173843130, 27403108, 246919194, 176394949, 64101329, 93435847, 37033881, 193548143, 76393112, 24598309, 195499713, 60358102, 4176497, 201328454, 227947159, 198826939, 56212016, 29486788, 39789083, 259938046, 214953131, 198409488, 57036151, 236311170, 94068584, 114831382, 86467032, 30311781, 46917583, 201945174, 109437248, 247327871, 183205078, 250917607, 206787660, 248684720, 212544856, 212544856, 212544856, 212544856, 47700621, 47700621, 47700621, 47700621, 54255629, 54255629, 54255629, 54255629, 232641881, 232641881, 232641881, 232641881, 241514581, 241514581, 241514581, 241514581, 34724453, 34724453, 34724453, 34724453, 169158745, 169158745, 169158745, 169158745, 82024613, 82024613, 82024613, 82024613, 135820148, 135820148, 135820148, 135820148, 15614207, 15614207, 15614207, 15614207, 169755471, 169755471, 169755471, 169755471, 244556575, 244556575, 244556575, 244556575, 69289705, 69289705, 69289705, 69289705, 234630723, 234630723, 234630723, 234630723, 107639639, 107639639, 107639639, 107639639, 88082865, 88082865, 88082865, 88082865, 49260366, 49260366, 49260366, 49260366, 97811270, 97811270, 97811270, 97811270, 182600836, 182600836, 182600836, 182600836, 239385267, 239385267, 239385267, 239385267, 189416188, 189416188, 189416188, 189416188, 260672840, 260672840, 260672840, 260672840, 178050285, 178050285, 178050285, 178050285, 245183842, 245183842, 245183842, 245183842, 51182490, 51182490, 51182490, 51182490, 219254001, 219254001, 219254001, 219254001, 27896355, 27896355, 27896355, 27896355, 43838285, 43838285, 43838285, 43838285, 212096425, 212096425, 212096425, 212096425, 44997598, 44997598, 44997598, 44997598, 170758240, 170758240, 170758240, 170758240, 75752806, 75752806, 75752806, 75752806, 169742456, 169742456, 169742456, 169742456, 182555989, 182555989, 182555989, 182555989, 13084797, 13084797, 13084797, 13084797, 61769817, 61769817, 61769817, 61769817, 41515544, 41515544, 41515544, 41515544, 154266055, 154266055, 154266055, 154266055, 55361065, 55361065, 55361065, 55361065, 92283106, 92283106, 92283106, 92283106, 92594417, 92594417, 92594417, 92594417, 83894791, 83894791, 83894791, 83894791, 192014372, 192014372, 192014372, 192014372, 161852304, 161852304, 161852304, 161852304, 118733768, 118733768, 118733768, 118733768, 235855195, 235855195, 235855195, 235855195, 202718088, 202718088, 202718088, 202718088, 222525757, 222525757, 222525757, 222525757, 239407266, 239407266, 239407266, 239407266, 116735397, 116735397, 116735397, 116735397, 42663290, 42663290, 42663290, 42663290, 223093330, 223093330, 223093330, 223093330, 137934613, 137934613, 137934613, 137934613, 105220469, 105220469, 105220469, 105220469, 139976775, 139976775, 139976775, 139976775, 125173605, 125173605, 125173605, 125173605, 47844302, 47844302, 47844302, 47844302, 159830083, 159830083, 159830083, 159830083, 190550194, 190550194, 190550194, 190550194, 160002168, 160002168, 160002168, 160002168, 29600115, 29600115, 29600115, 29600115, 125614867, 125614867, 125614867, 125614867, 157811508, 157811508, 157811508, 157811508, 254488521, 254488521, 254488521, 254488521, 109306076, 109306076, 109306076, 109306076, 14828837, 14828837, 14828837, 14828837, 60241193, 60241193, 60241193, 60241193, 21185961, 21185961, 21185961, 21185961, 204624902, 204624902, 204624902, 204624902, 56451505, 56451505, 56451505, 56451505, 238210662, 238210662, 238210662, 238210662, 155832655, 155832655, 155832655, 155832655, 126599277, 126599277, 126599277, 126599277, 228932120, 228932120, 228932120, 228932120, 58708535, 58708535, 58708535, 58708535, 246636665, 246636665, 246636665, 246636665, 134620667, 134620667, 134620667, 134620667, 219004188, 219004188, 219004188, 219004188, 225365057, 225365057, 225365057, 225365057, 86545478, 86545478, 86545478, 86545478, 226526434, 226526434, 226526434, 226526434, 5868665, 5868665, 5868665, 5868665, 66278696, 66278696, 66278696, 66278696, 70519747, 70519747, 70519747, 70519747, 219568494, 219568494, 219568494, 219568494, 102283048, 102283048, 102283048, 102283048, 69899367, 69899367, 69899367, 69899367, 250122243, 250122243, 250122243, 250122243, 81989881, 81989881, 81989881, 81989881, 127364102, 127364102, 127364102, 127364102, 221942451, 221942451, 221942451, 221942451, 241789631, 241789631, 241789631, 241789631, 24385879, 24385879, 24385879, 24385879, 215121335, 215121335, 215121335, 215121335, 20619967, 20619967, 20619967, 20619967, 118598247, 118598247, 118598247, 118598247, 50105098, 50105098, 50105098, 50105098, 135459003, 135459003, 135459003, 135459003, 122700757, 122700757, 122700757, 122700757, 58322241, 58322241, 58322241, 58322241, 88443424, 88443424, 88443424, 88443424, 11135490, 11135490, 11135490, 11135490, 26871648, 26871648, 26871648, 26871648, 217416159, 217416159, 217416159, 217416159, 63208100, 63208100, 63208100, 63208100, 225383770, 225383770, 225383770, 225383770, 181962646, 181962646, 181962646, 181962646, 230787111, 230787111, 230787111, 230787111, 130087884, 130087884, 130087884, 130087884, 234810534, 234810534, 234810534, 234810534, 55213622, 55213622, 55213622, 55213622, 263884253, 263884253, 263884253, 263884253, 148911136, 148911136, 148911136, 148911136, 35355614, 35355614, 35355614, 35355614, 209977766, 209977766, 209977766, 209977766, 96932292, 96932292, 96932292, 96932292, 219211541, 219211541, 219211541, 219211541, 263465853, 263465853, 263465853, 263465853, 174895514, 174895514, 174895514, 174895514, 136509822, 136509822, 136509822, 136509822, 259510941, 259510941, 259510941, 259510941, 232581902, 232581902, 232581902, 232581902, 84748982, 84748982, 84748982, 84748982, 178774170, 178774170, 178774170, 178774170, 69047364, 69047364, 69047364, 69047364, 53644666, 53644666, 53644666, 53644666, 63841393, 63841393, 63841393, 63841393, 241299650, 241299650, 241299650, 241299650, 213222567, 213222567, 84087691, 84087691, 54464209, 54464209, 233527112, 233527112, 101328015, 101328015, 175880461, 175880461, 130690735, 130690735, 242906212, 242906212, 35367297, 35367297, 142614493, 142614493, 237971965, 237971965, 45327285, 45327285, 204239662, 204239662, 60844016, 60844016, 114764626, 114764626, 11872910, 11872910, 264499180, 264499180, 98413737, 98413737, 67129851, 67129851, 32287223, 32287223, 90646657, 90646657, 176957907, 176957907, 262647990, 262647990, 41493280, 41493280, 151916483, 151916483, 185259808, 185259808, 221082134, 221082134, 9660624, 9660624, 215851801, 215851801, 199104327, 199104327, 227916407, 227916407, 140081982, 140081982, 139800987, 139800987, 47546465, 47546465, 142359702, 142359702, 73996121, 73996121, 48447254, 48447254, 71699791, 71699791, 6006691, 6006691, 125185721, 125185721, 22177405, 22177405, 95338264, 95338264, 266817516, 266817516, 267776308, 267776308, 87923415, 87923415, 215461773, 215461773, 46276702, 46276702, 75729573, 75729573, 212401194, 212401194, 12105579, 12105579, 201264410, 201264410, 206178451, 206178451, 3795142, 3795142, 215495551, 215495551, 139664632, 139664632, 254912587, 254912587, 231474114, 231474114, 216113448, 216113448, 224794109, 224794109, 258591616, 258591616, 251749299, 251749299, 155831276, 155831276, 103422682, 103422682, 155968480, 155968480, 259894270, 259894270, 244833278, 244833278, 67885960, 67885960, 237390985, 237390985, 141743723, 141743723, 229395587, 229395587, 15401359, 15401359, 179267655, 179267655, 186197887, 186197887, 169527668, 169527668, 2585682, 2585682, 44476910, 44476910, 88469527, 88469527, 174450388, 174450388, 107457603, 107457603, 35195910, 35195910, 171721956, 171721956, 3375122, 3375122, 121080115, 121080115, 211199046, 211199046, 79350909, 79350909, 12538600, 12538600, 120125927, 120125927, 91647515, 91647515, 142924000, 142924000, 262342230, 262342230, 228825707, 228825707, 66332831, 66332831, 40913410, 40913410, 149725819, 149725819, 192805230, 192805230, 60957696, 60957696, 6577981, 6577981, 179706169, 179706169, 73714590, 73714590, 169173312, 169173312, 122875285, 122875285, 1814960, 1814960, 254151276, 254151276, 224412936, 224412936, 87241605, 87241605, 136059418, 136059418, 126649140, 126649140, 132949551, 132949551, 215318117, 215318117, 118792344, 118792344, 197603592, 197603592, 156819158, 156819158, 263920684, 263920684, 24653838, 24653838, 158591940, 158591940, 190980772, 190980772, 149518455, 149518455, 252114568, 252114568, 78848897, 78848897, 39435205, 39435205, 83285202, 83285202, 41318958, 41318958, 132644861, 132644861, 60186811, 60186811, 45910865, 45910865, 213027294, 213027294, 202460433, 202460433, 183203150, 183203150, 43854857, 43854857, 200237411, 200237411, 214982144, 214982144, 256635112, 256635112, 252133948, 252133948, 43431397, 43431397, 214043479, 214043479, 24507844, 24507844, 245785804, 245785804, 97403933, 97403933, 65560947, 65560947, 48376194, 48376194, 35115281, 35115281, 134779370, 134779370, 158867203, 158867203, 252726214, 252726214, 238595734, 238595734, 244097059, 244097059, 179603523, 179603523, 129452612, 129452612, 158456273, 158456273, 215656679, 215656679, 71781986, 71781986, 185419136, 185419136, 29639006, 29639006, 85352118, 85352118, 230287865, 230287865, 216240545, 216240545, 238210011, 238210011, 230487202, 230487202, 104844559, 104844559, 28812971, 28812971, 141293537, 141293537, 89005556, 89005556, 156020923, 156020923, 9735446, 9735446, 14771150, 14771150, 195582783, 195582783, 195209751, 195209751, 165608647, 165608647, 146167753, 146167753, 55659570, 55659570, 263837025, 263837025, 49847530, 49847530, 252394911, 252394911, 149315284, 149315284, 99614470, 99614470, 139420675, 139420675, 157413167, 157413167, 2106320, 2106320, 257671331, 257671331, 162891917, 162891917, 74485971, 74485971, 117290743, 117290743, 38896027, 38896027, 170221436, 170221436, 20149341, 20149341, 162222397, 162222397, 225468478, 225468478, 32769343, 32769343, 195192678, 195192678, 2358316, 2358316, 241167290, 241167290, 168689341, 168689341, 173097913, 173097913, 91159182, 91159182, 113951694, 113951694, 120024341, 120024341, 165737187, 165737187, 198499104, 198499104, 159789365, 159789365, 210039754, 210039754, 215741507, 215741507, 19799202, 19799202, 131502209, 131502209, 185616753, 185616753, 177908243, 177908243, 42716218, 42716218, 163215298, 163215298, 2260088, 2260088, 9492168, 9492168, 70349640, 70349640, 26456614, 26456614, 186820728, 186820728, 62952182, 62952182, 42206167, 42206167, 177103728, 177103728, 140748281, 140748281, 51117361, 51117361, 56897505, 56897505, 194459001, 194459001, 201393225, 201393225, 260873166, 260873166, 156356145, 156356145, 192642412, 192642412, 219459840, 219459840, 22792662, 22792662, 188616377, 188616377, 256682781, 256682781, 151842381, 151842381, 219635073, 219635073, 195028465, 195028465, 73662913, 73662913, 142012920, 142012920, 264474674, 264474674, 230176129, 230176129, 214632666, 214632666, 64048809, 64048809, 17183524, 17183524, 247933598, 247933598, 258782592, 258782592, 111172727, 111172727, 32449580, 32449580, 250666288, 250666288, 230157920, 230157920, 172013019, 172013019, 232616967, 232616967, 174246190, 174246190, 100872690, 100872690, 62332894, 62332894, 85235808, 85235808, 137874262, 137874262, 132269322, 132269322, 254271755, 254271755, 251037242, 251037242, 92926626, 92926626, 143872451, 143872451, 164132964, 164132964 };

int32_t zetas_inv_avx[1152] = { 104276893, 104276893, 124537406, 124537406, 175483231, 175483231, 17372615, 17372615, 14138102, 14138102, 136140535, 136140535, 130535595, 130535595, 183174049, 183174049, 206076963, 206076963, 167537167, 167537167, 94163667, 94163667, 35792890, 35792890, 96396838, 96396838, 38251937, 38251937, 17743569, 17743569, 235960277, 235960277, 157237130, 157237130, 9627265, 9627265, 20476259, 20476259, 251226333, 251226333, 204361048, 204361048, 53777191, 53777191, 38233728, 38233728, 3935183, 3935183, 126396937, 126396937, 194746944, 194746944, 73381392, 73381392, 48774784, 48774784, 116567476, 116567476, 11727076, 11727076, 79793480, 79793480, 245617195, 245617195, 48950017, 48950017, 75767445, 75767445, 112053712, 112053712, 7536691, 7536691, 67016632, 67016632, 73950856, 73950856, 211512352, 211512352, 217292496, 217292496, 127661576, 127661576, 91306129, 91306129, 226203690, 226203690, 205457675, 205457675, 81589129, 81589129, 241953243, 241953243, 198060217, 198060217, 258917689, 258917689, 266149769, 266149769, 105194559, 105194559, 225693639, 225693639, 90501614, 90501614, 82793104, 82793104, 136907648, 136907648, 248610655, 248610655, 52668350, 52668350, 58370103, 58370103, 108620492, 108620492, 69910753, 69910753, 102672670, 102672670, 148385516, 148385516, 154458163, 154458163, 177250675, 177250675, 95311944, 95311944, 99720516, 99720516, 27242567, 27242567, 266051541, 266051541, 73217179, 73217179, 235640514, 235640514, 42941379, 42941379, 106187460, 106187460, 248260516, 248260516, 98188421, 98188421, 229513830, 229513830, 151119114, 151119114, 193923886, 193923886, 105517940, 105517940, 10738526, 10738526, 266303537, 266303537, 110996690, 110996690, 128989182, 128989182, 168795387, 168795387, 119094573, 119094573, 16014946, 16014946, 218562327, 218562327, 4572832, 4572832, 212750287, 212750287, 122242104, 122242104, 102801210, 102801210, 73200106, 73200106, 72827074, 72827074, 253638707, 253638707, 258674411, 258674411, 112388934, 112388934, 179404301, 179404301, 127116320, 127116320, 239596886, 239596886, 163565298, 163565298, 37922655, 37922655, 30199846, 30199846, 52169312, 52169312, 38121992, 38121992, 183057739, 183057739, 238770851, 238770851, 82990721, 82990721, 196627871, 196627871, 52753178, 52753178, 109953584, 109953584, 138957245, 138957245, 88806334, 88806334, 24312798, 24312798, 29814123, 29814123, 15683643, 15683643, 109542654, 109542654, 133630487, 133630487, 233294576, 233294576, 220033663, 220033663, 202848910, 202848910, 171005924, 171005924, 22624053, 22624053, 243902013, 243902013, 54366378, 54366378, 224978460, 224978460, 16275909, 16275909, 11774745, 11774745, 53427713, 53427713, 68172446, 68172446, 224555000, 224555000, 85206707, 85206707, 65949424, 65949424, 55382563, 55382563, 222498992, 222498992, 208223046, 208223046, 135764996, 135764996, 227090899, 227090899, 185124655, 185124655, 228974652, 228974652, 189560960, 189560960, 16295289, 16295289, 118891402, 118891402, 77429085, 77429085, 109817917, 109817917, 243756019, 243756019, 4489173, 4489173, 111590699, 111590699, 70806265, 70806265, 149617513, 149617513, 53091740, 53091740, 135460306, 135460306, 141760717, 141760717, 132350439, 132350439, 181168252, 181168252, 43996921, 43996921, 14258581, 14258581, 266594897, 266594897, 145534572, 145534572, 99236545, 99236545, 194695267, 194695267, 88703688, 88703688, 261831876, 261831876, 207452161, 207452161, 75604627, 75604627, 118684038, 118684038, 227496447, 227496447, 202077026, 202077026, 39584150, 39584150, 6067627, 6067627, 125485857, 125485857, 176762342, 176762342, 148283930, 148283930, 255871257, 255871257, 189058948, 189058948, 57210811, 57210811, 147329742, 147329742, 265034735, 265034735, 96687901, 96687901, 233213947, 233213947, 160952254, 160952254, 93959469, 93959469, 179940330, 179940330, 223932947, 223932947, 265824175, 265824175, 98882189, 98882189, 82211970, 82211970, 89142202, 89142202, 253008498, 253008498, 39014270, 39014270, 126666134, 126666134, 31018872, 31018872, 200523897, 200523897, 23576579, 23576579, 8515587, 8515587, 112441377, 112441377, 164987175, 164987175, 112578581, 112578581, 16660558, 16660558, 9818241, 9818241, 43615748, 43615748, 52296409, 52296409, 36935743, 36935743, 13497270, 13497270, 128745225, 128745225, 52914306, 52914306, 264614715, 264614715, 62231406, 62231406, 67145447, 67145447, 256304278, 256304278, 56008663, 56008663, 192680284, 192680284, 222133155, 222133155, 52948084, 52948084, 180486442, 180486442, 633549, 633549, 1592341, 1592341, 173071593, 173071593, 246232452, 246232452, 143224136, 143224136, 262403166, 262403166, 196710066, 196710066, 219962603, 219962603, 194413736, 194413736, 126050155, 126050155, 220863392, 220863392, 128608870, 128608870, 128327875, 128327875, 40493450, 40493450, 69305530, 69305530, 52558056, 52558056, 258749233, 258749233, 47327723, 47327723, 83150049, 83150049, 116493374, 116493374, 226916577, 226916577, 5761867, 5761867, 91451950, 91451950, 177763200, 177763200, 236122634, 236122634, 201280006, 201280006, 169996120, 169996120, 3910677, 3910677, 256536947, 256536947, 153645231, 153645231, 207565841, 207565841, 64170195, 64170195, 223082572, 223082572, 30437892, 30437892, 125795364, 125795364, 233042560, 233042560, 25503645, 25503645, 137719122, 137719122, 92529396, 92529396, 167081842, 167081842, 34882745, 34882745, 213945648, 213945648, 184322166, 184322166, 55187290, 55187290, 27110207, 27110207, 27110207, 27110207, 204568464, 204568464, 204568464, 204568464, 214765191, 214765191, 214765191, 214765191, 199362493, 199362493, 199362493, 199362493, 89635687, 89635687, 89635687, 89635687, 183660875, 183660875, 183660875, 183660875, 35827955, 35827955, 35827955, 35827955, 8898916, 8898916, 8898916, 8898916, 131900035, 131900035, 131900035, 131900035, 93514343, 93514343, 93514343, 93514343, 4944004, 4944004, 4944004, 4944004, 49198316, 49198316, 49198316, 49198316, 171477565, 171477565, 171477565, 171477565, 58432091, 58432091, 58432091, 58432091, 233054243, 233054243, 233054243, 233054243, 119498721, 119498721, 119498721, 119498721, 4525604, 4525604, 4525604, 4525604, 213196235, 213196235, 213196235, 213196235, 33599323, 33599323, 33599323, 33599323, 138321973, 138321973, 138321973, 138321973, 37622746, 37622746, 37622746, 37622746, 86447211, 86447211, 86447211, 86447211, 43026087, 43026087, 43026087, 43026087, 205201757, 205201757, 205201757, 205201757, 50993698, 50993698, 50993698, 50993698, 241538209, 241538209, 241538209, 241538209, 257274367, 257274367, 257274367, 257274367, 179966433, 179966433, 179966433, 179966433, 210087616, 210087616, 210087616, 210087616, 145709100, 145709100, 145709100, 145709100, 132950854, 132950854, 132950854, 132950854, 218304759, 218304759, 218304759, 218304759, 149811610, 149811610, 149811610, 149811610, 247789890, 247789890, 247789890, 247789890, 53288522, 53288522, 53288522, 53288522, 244023978, 244023978, 244023978, 244023978, 26620226, 26620226, 26620226, 26620226, 46467406, 46467406, 46467406, 46467406, 141045755, 141045755, 141045755, 141045755, 186419976, 186419976, 186419976, 186419976, 18287614, 18287614, 18287614, 18287614, 198510490, 198510490, 198510490, 198510490, 166126809, 166126809, 166126809, 166126809, 48841363, 48841363, 48841363, 48841363, 197890110, 197890110, 197890110, 197890110, 202131161, 202131161, 202131161, 202131161, 262541192, 262541192, 262541192, 262541192, 41883423, 41883423, 41883423, 41883423, 181864379, 181864379, 181864379, 181864379, 43044800, 43044800, 43044800, 43044800, 49405669, 49405669, 49405669, 49405669, 133789190, 133789190, 133789190, 133789190, 21773192, 21773192, 21773192, 21773192, 209701322, 209701322, 209701322, 209701322, 39477737, 39477737, 39477737, 39477737, 141810580, 141810580, 141810580, 141810580, 112577202, 112577202, 112577202, 112577202, 30199195, 30199195, 30199195, 30199195, 211958352, 211958352, 211958352, 211958352, 63784955, 63784955, 63784955, 63784955, 247223896, 247223896, 247223896, 247223896, 208168664, 208168664, 208168664, 208168664, 253581020, 253581020, 253581020, 253581020, 159103781, 159103781, 159103781, 159103781, 13921336, 13921336, 13921336, 13921336, 110598349, 110598349, 110598349, 110598349, 142794990, 142794990, 142794990, 142794990, 238809742, 238809742, 238809742, 238809742, 108407689, 108407689, 108407689, 108407689, 77859663, 77859663, 77859663, 77859663, 108579774, 108579774, 108579774, 108579774, 220565555, 220565555, 220565555, 220565555, 143236252, 143236252, 143236252, 143236252, 128433082, 128433082, 128433082, 128433082, 163189388, 163189388, 163189388, 163189388, 130475244, 130475244, 130475244, 130475244, 45316527, 45316527, 45316527, 45316527, 225746567, 225746567, 225746567, 225746567, 151674460, 151674460, 151674460, 151674460, 29002591, 29002591, 29002591, 29002591, 45884100, 45884100, 45884100, 45884100, 65691769, 65691769, 65691769, 65691769, 32554662, 32554662, 32554662, 32554662, 149676089, 149676089, 149676089, 149676089, 106557553, 106557553, 106557553, 106557553, 76395485, 76395485, 76395485, 76395485, 184515066, 184515066, 184515066, 184515066, 175815440, 175815440, 175815440, 175815440, 176126751, 176126751, 176126751, 176126751, 213048792, 213048792, 213048792, 213048792, 114143802, 114143802, 114143802, 114143802, 226894313, 226894313, 226894313, 226894313, 206640040, 206640040, 206640040, 206640040, 255325060, 255325060, 255325060, 255325060, 85853868, 85853868, 85853868, 85853868, 98667401, 98667401, 98667401, 98667401, 192657051, 192657051, 192657051, 192657051, 97651617, 97651617, 97651617, 97651617, 223412259, 223412259, 223412259, 223412259, 56313432, 56313432, 56313432, 56313432, 224571572, 224571572, 224571572, 224571572, 240513502, 240513502, 240513502, 240513502, 49155856, 49155856, 49155856, 49155856, 217227367, 217227367, 217227367, 217227367, 23226015, 23226015, 23226015, 23226015, 90359572, 90359572, 90359572, 90359572, 7737017, 7737017, 7737017, 7737017, 78993669, 78993669, 78993669, 78993669, 29024590, 29024590, 29024590, 29024590, 85809021, 85809021, 85809021, 85809021, 170598587, 170598587, 170598587, 170598587, 219149491, 219149491, 219149491, 219149491, 180326992, 180326992, 180326992, 180326992, 160770218, 160770218, 160770218, 160770218, 33779134, 33779134, 33779134, 33779134, 199120152, 199120152, 199120152, 199120152, 23853282, 23853282, 23853282, 23853282, 98654386, 98654386, 98654386, 98654386, 252795650, 252795650, 252795650, 252795650, 132589709, 132589709, 132589709, 132589709, 186385244, 186385244, 186385244, 186385244, 99251112, 99251112, 99251112, 99251112, 233685404, 233685404, 233685404, 233685404, 26895276, 26895276, 26895276, 26895276, 35767976, 35767976, 35767976, 35767976, 214154228, 214154228, 214154228, 214154228, 220709236, 220709236, 220709236, 220709236, 55865001, 55865001, 55865001, 55865001, 19725137, 61622197, 17492250, 85204779, 21081986, 158972609, 66464683, 221492274, 238098076, 181942825, 153578475, 174341273, 32098687, 211373706, 70000369, 53456726, 8471811, 228620774, 238923069, 212197841, 69582918, 40462698, 67081403, 264233360, 208051755, 72910144, 243811548, 192016745, 74861714, 231375976, 174974010, 204308528, 92014908, 21490663, 241006749, 94566727, 95565311, 102200576, 55704205, 210718587, 111141684, 199297921, 52503789, 3109061, 154630931, 177101942, 7175849, 248235960, 11281441, 253210903, 7317947, 14688841, 234122183, 216926023, 4280429, 99119778, 219611707, 163283575, 100187325, 164745794, 127919653, 128805321, 247700096, 229750955, 26061559, 94039261, 46430743, 124956943, 104312576, 126637483, 226272206, 21368027, 187775283, 132739334, 204142015, 33818663, 172397962, 82385079, 224607402, 162837548, 24171471, 140577464, 131220115, 64254746, 142071422, 62163910, 98642826, 207440533, 85698770, 205029674, 243045626, 171105221, 255856975, 261541380, 224042004, 400263, 257974218, 81756493, 122448804, 85115249, 103695500, 261445614, 63337018, 73650307, 67792343, 131181230, 211296553, 99533342, 71258088, 71681557, 201372946, 225229381, 137074816, 261363856, 93643478, 150138010, 22967498, 190060235, 145863709, 53342283, 257220290, 63968947, 33269620, 212767804, 231707640, 97861003, 155421717, 193449472 };

const uint64_t _64xbarrettv[4] __attribute__((aligned(32))) = { BARRETT_REDUCE_V, BARRETT_REDUCE_V, BARRETT_REDUCE_V, BARRETT_REDUCE_V
};
const uint32_t _32zeta_final[8] __attribute__((aligned(32))) = { ZETA_INV_FINAL, ZETA_INV_FINAL, ZETA_INV_FINAL, ZETA_INV_FINAL, ZETA_INV_FINAL, ZETA_INV_FINAL, ZETA_INV_FINAL, ZETA_INV_FINAL
};

const uint32_t _32xq[16] __attribute__((aligned(32))) = { Q, Q, Q, Q, Q, Q, Q, Q
};
const int32_t _32xqinv[16] __attribute__((aligned(32))) = { QINV_S32, QINV_S32, QINV_S32, QINV_S32, QINV_S32, QINV_S32, QINV_S32, QINV_S32, QINV_S32, QINV_S32, QINV_S32, QINV_S32, QINV_S32, QINV_S32, QINV_S32, QINV_S32
};